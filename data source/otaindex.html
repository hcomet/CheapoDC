<!DOCTYPE html>
<html lang="en">

<head>
   <title>CheapoDC Device Management</title>
   <link rel="icon" type="image/png" href="/favicon.png">
   <link rel="stylesheet" href="./CDCStyle.css?v=1.1">
</head>

<body>
   <div id="loader"></div>
   <div class="config">
      <header>
         <div class="headerGrid">
            <hIcon class="logo"><img src="/cheapo.png" alt="CheapoDC"
                  onclick="window.location.href='https://github.com/hcomet/CheapoDC'"></hIcon>
            <hTitle class="title">Device Management</hTitle>
            <logoutIcon onclick="logoutCDC()"><img src="/logout.png" alt="Logout"></logoutIcon>
         </div>
      </header>
      <main>
         <h2 class="mb5">Controller Output Configuration</h2>
         <div class="cf2clm">
            <div class="cfcl1">
               <h3>Controller Output 0</h3>
               <div class="cfln">
                  <cfitm>GPIO:</cfitm>
                  <cfvl>
                     <div class="crdg"><input type="number" name="CPP0" step="1" min="-1" max="39" class="cinp"
                           id="CPP0I" data-cdc="%CPP0%" /></div>
                  </cfvl>
                  <cfact><button type="button" class="cbtn" id="CPP0" disabled>Update</button></cfact>
               </div>
               <div class="cfln">
                  <cfitm>Mode:</cfitm>
                  <cfvl>
                     <div class="crdg"><select name="CPM0" id="CPM0S" data-cdc="%CPM0%">
                           <option id="Disabled" value="0">Disabled</option>
                           <option id="Controller" value="1">Controller</option>
                        </select>
                     </div>
                  </cfvl>
                  <cfact><button type="button" class="cbtn" id="CPM0" disabled>Update</button></cfact>
               </div>
               <div class="cfln">
                  <cfitm>Output (&percnt;):</cfitm>
                  <cfvl>
                     <div class="crdg"><input type="number" name="CPO0" disabled class="cinp" id="CPO0I"
                           data-cdc="%CPO0%" /></div>
                  </cfvl>
                  <cfact><button type="button fn" class="cbtn hidden" id="CPO0" disabled>Update</button>
                  </cfact>
               </div>
            </div>
            <div class="cfcl2">
               <h3>Controller Output 1</h3>
               <div class="cfln">
                  <cfitm>GPIO:</cfitm>
                  <cfvl>
                     <div class="crdg"><input type="number" name="CPP1" step="1" min="-1" max="39" class="cinp"
                           id="CPP1I" data-cdc="%CPP1%" /></div>
                  </cfvl>
                  <cfact><button type="button" class="cbtn" id="CPP1" disabled>Update</button></cfact>
               </div>
               <div class="cfln">
                  <cfitm>Mode:</cfitm>
                  <cfvl>
                     <div class="crdg"><select name="CPM1" id="CPM1S" data-cdc="%CPM1%">
                           <option id="Disabled" value="0">Disabled</option>
                           <option id="Controller" value="1">Controller</option>
                        </select>
                     </div>
                  </cfvl>
                  <cfact><button type="button" class="cbtn" id="CPM1" disabled>Update</button></cfact>
               </div>
               <div class="cfln">
                  <cfitm>Output (&percnt;):</cfitm>
                  <cfvl>
                     <div class="crdg"><input type="number" disabled class="cinp" id="CPO1I" data-cdc="%CPO1%" />
                     </div>
                  </cfvl>
                  <cfact><button type="button fn" class="cbtn hidden" id="CPO1" disabled>Update</button>
                  </cfact>
               </div>
            </div>
         </div>
         <div class="cf2clm">
            <div class="cfcl1">
               <h3>Controller Output 2</h3>
               <div class="cfln">
                  <cfitm>GPIO:</cfitm>
                  <cfvl>
                     <div class="crdg"><input type="number" name="CPP2" step="1" min="-1" max="39" class="cinp"
                           id="CPP2I" data-cdc="%CPP2%" /></div>
                  </cfvl>
                  <cfact><button type="button" class="cbtn" id="CPP2" disabled>Update</button></cfact>
               </div>
               <div class="cfln">
                  <cfitm>Mode:</cfitm>
                  <cfvl>
                     <div class="crdg"><select name="CPM2" id="CPM2S" data-cdc="%CPM2%">
                           <option id="Disabled" value="0">Disabled</option>
                           <option id="Controller" value="1">Controller</option>
                           <option id="PWM" value="2">PWM</option>
                           <option id="Boolean" value="3">Boolean</option>
                        </select>
                     </div>
                  </cfvl>
                  <cfact><button type="button" class="cbtn" id="CPM2" disabled>Update</button></cfact>
               </div>
               <div class="cfln">
                  <cfitm>Output (&percnt;):</cfitm>
                  <cfvl>
                     <div class="crdg"><input type="number" name="CPO2" step="1" min="0" max="100" class="cinp"
                           id="CPO2I" data-cdc="%CPO2%" /></div>
                  </cfvl>
                  <cfact><button type="button fn" class="cbtn" id="CPO2" disabled>Update</button>
                  </cfact>
               </div>
            </div>
            <div class="cfcl2">
               <h3>Controller Output 3</h3>
               <div class="cfln">
                  <cfitm>GPIO:</cfitm>
                  <cfvl>
                     <div class="crdg"><input type="number" name="CPP3" step="1" min="-1" max="39" class="cinp"
                           id="CPP3I" data-cdc="%CPP3%" /></div>
                  </cfvl>
                  <cfact><button type="button" class="cbtn" id="CPP3" disabled>Update</button></cfact>
               </div>
               <div class="cfln">
                  <cfitm>Mode:</cfitm>
                  <cfvl>
                     <div class="crdg"><select name="CPM3" id="CPM3S" data-cdc="%CPM3%">
                           <option id="Disabled" value="0">Disabled</option>
                           <option id="Controller" value="1">Controller</option>
                           <option id="PWM" value="2">PWM</option>
                           <option id="Boolean" value="3">Boolean</option>
                        </select>
                     </div>
                  </cfvl>
                  <cfact><button type="button" class="cbtn" id="CPM3" disabled>Update</button></cfact>
               </div>
               <div class="cfln">
                  <cfitm>Output (&percnt;):</cfitm>
                  <cfvl>
                     <div class="crdg"><input type="number" name="CPO3" step="1" min="0" max="100" class="cinp"
                           id="CPO3I" data-cdc="%CPO3%" /></div>
                  </cfvl>
                  <cfact><button type="button" class="cbtn" id="CPO3" disabled>Update</button></cfact>
               </div>
            </div>
         </div>
         <div class="cf2clm">
            <div class="cfcl1">
               <h3>Controller Output 4</h3>
               <div class="cfln">
                  <cfitm>GPIO:</cfitm>
                  <cfvl>
                     <div class="crdg"><input type="number" name="CPP4" step="1" min="-1" max="39" class="cinp"
                           id="CPP4I" data-cdc="%CPP4%" /></div>
                  </cfvl>
                  <cfact><button type="button" class="cbtn" id="CPP4" disabled>Update</button></cfact>
               </div>
               <div class="cfln">
                  <cfitm>Mode:</cfitm>
                  <cfvl>
                     <div class="crdg"><select name="CPM4" id="CPM4S" data-cdc="%CPM4%">
                           <option id="Disabled" value="0">Disabled</option>
                           <option id="Controller" value="1">Controller</option>
                           <option id="PWM" value="2">PWM</option>
                           <option id="Boolean" value="3">Boolean</option>
                        </select>
                     </div>
                  </cfvl>
                  <cfact><button type="button" class="cbtn" id="CPM4" disabled>Update</button></cfact>
               </div>
               <div class="cfln">
                  <cfitm>Output (&percnt;):</cfitm>
                  <cfvl>
                     <div class="crdg"><input type="number" name="CPO4" step="1" min="0" max="100" class="cinp"
                           id="CPO4I" data-cdc="%CPO4%" /></div>
                  </cfvl>
                  <cfact><button type="button" class="cbtn" id="CPO4" disabled>Update</button></cfact>
               </div>
            </div>
            <div class="cfcl2">
               <h3>Controller Output 5</h3>
               <div class="cfln">
                  <cfitm>GPIO:</cfitm>
                  <cfvl>
                     <div class="crdg"><input type="number" name="CPP5" step="1" min="-1" max="39" class="cinp"
                           id="CPP5I" data-cdc="%CPP5%" /></div>
                  </cfvl>
                  <cfact><button type="button" class="cbtn" id="CPP5" disabled>Update</button></cfact>
               </div>
               <div class="cfln">
                  <cfitm>Mode:</cfitm>
                  <cfvl>
                     <div class="crdg"><select name="CPM5" id="CPM5S" data-cdc="%CPM5%">
                           <option id="Disabled" value="0">Disabled</option>
                           <option id="Controller" value="1">Controller</option>
                           <option id="PWM" value="2">PWM</option>
                           <option id="Boolean" value="3">Boolean</option>
                        </select>
                     </div>
                  </cfvl>
                  <cfact><button type="button" class="cbtn" id="CPM5" disabled>Update</button></cfact>
               </div>
               <div class="cfln">
                  <cfitm>Output (&percnt;):</cfitm>
                  <cfvl>
                     <div class="crdg"><input type="number" name="CPO5" step="1" min="0" max="100" class="cinp"
                           id="CPO5I" data-cdc="%CPO5%" /></div>
                  </cfvl>
                  <cfact><button type="button" class="cbtn" id="CPO5" disabled>Update</button></cfact>
               </div>
            </div>
         </div>
         <hr class="confighr">
         <h2 class="mb5">WiFi Configuration</h2>
      <div class="cf2clm">
         <div class="cfcl1">
            <h3>Network Information</h3>
            <div class="cfln">
               <cfitm>WiFi Mode:</cfitm>
               <cfvl>
                  <div class="crdg"><input type="text" name="WIFI" class="cinp" id="WIFII" disabled
                     data-cdc="%WIFI%" /></div>
               </cfvl>
               <cfact><button type="button" class="cbtn hidden" id="WIFI">Update</button></cfact>
            </div>
            <div class="cfln">
               <cfitm>Hostname:</cfitm>
               <cfvl>
                  <div class="crdg"><input type="text" name="hostname" class="cinp" id="hostname" value="%HN%" data-cdc="%HN%"/></div>
               </cfvl>
               <cfact><button type="button" class="cbtn" id="hnButton" onclick="updateHostname()">Update</button></cfact>
            </div>
            <div class="cfln">
               <cfitm>IP Address:</cfitm>
               <cfvl>
                  <div class="crdg"><input type="text" name="IP" class="cinp" id="IPI" disabled
                     data-cdc="%IP%" /></div>
               </cfvl>
               <cfact><button type="button" class="cbtn hidden" id="IP">Update</button>
               </cfact>
            </div>
         </div>
         <div class="cfcl2">
            <h3>Configure WiFi</h3>
            <div class="cfln">
               <cfitm>Name:</cfitm>
               <cfvl>
                  <div class="crdg"><select name="wifiName" id="wifiName"></select></div>
               </cfvl>
               <cfact><button type="button" class="cbtn hidden" disabled>Update</button></cfact>
            </div>
            <div class="cfln">
               <cfitm>SSID:</cfitm>
               <cfvl>
                  <div class="crdg"><input type="text" name="wifiSSID" id="wifiSSID"  class="cinp"/>
                  </div>
               </cfvl>
               <cfact><button type="button" class="cbtn hidden" disabled>Update</button></cfact>
            </div>
            <div class="cfln">
               <cfitm>Password:</cfitm>
               <cfvl>
                  <div class="crdg"><input type="password" name="wifiPassword" id="wifiPassword"  class="cinp"/>
                  </div>
               </cfvl>
               <cfact><button type="button" class="cbtn" id="wifiButton" disabled onclick="updateWifi()">Update</button></cfact>
            </div>
            <div class="cfln">
               <cfitm></cfitm>
               <cfvl><input type="checkbox" id="wifiPwdCheck" onclick="showWifiPassword()">Show Password</cfvl>
               <cfact></cfact>
            </div>
         </div>
      </div>
      <p id="wifiMessage" class="in30 errorText" display="hidden"></p>
         <hr class="confighr">
         <h2>Change Password</h2>
         <form id="passwordForm" method="POST" action="/setpassword">
            <input type="password" name="newpassword" id="newpassword" placeholder="New Password" required>
            <input type="password" name="confpassword" id="confpassword" placeholder="Confirm New Password" required>
            <input type="password" name="oldpassword" id="oldpassword" placeholder="Current Password" required>
            <button type="button" id="passwordButton" onclick="changePassword()" disabled>Update</button>
         </form> <br>
         <hr class="confighr">
         <h2>Humidity Sensor Configuration</h2>
         <div class="cf2clm">
            <div class="cfcl1">
               <div class="cfln">
                  <cfitm>SDA GPIO:</cfitm>
                  <cfvl>
                     <div class="crdg"><input type="number" name="LED" step="1" min="-1" max="39" class="cinp"
                           id="SDAPI" data-cdc="%SDAP%" /></div>
                  </cfvl>
                  <cfact><button type="button" class="cbtn" id="SDAP" disabled>Update</button></cfact>
               </div>
            </div>
            <div class="cfcl2">
               <div class="cfln">
                  <cfitm>SCL GPIO:</cfitm>
                  <cfvl>
                     <div class="crdg"><input type="number" name="LED" step="1" min="-1" max="39" class="cinp"
                           id="SCLPI" data-cdc="%SCLP%" /></div>
                  </cfvl>
                  <cfact><button type="button" class="cbtn" id="SCLP" disabled>Update</button></cfact>
               </div>
            </div>
         </div>
         <hr class="confighr">
         <h2>Status LED Configuration</h2>
         <div class="cf2clm">
            <div class="cfcl1">
               <div class="cfln">
                  <cfitm>GPIO:</cfitm>
                  <cfvl>
                     <div class="crdg"><input type="number" name="LED" step="1" min="-1" max="39" class="cinp"
                           id="LEDI" data-cdc="%LED%" /></div>
                  </cfvl>
                  <cfact><button type="button" class="cbtn" id="LED" disabled>Update</button></cfact>
               </div>
            </div>
            <div class="cfcl2">
               <div class="cfln">
                  <cfitm>High Value:</cfitm>
                  <cfvl>
                     <div class="crdg"><select name="LEDH" id="LEDHS" data-cdc="%LEDH%" value="%LEDH%">
                           <option id="0" value="0">0</option>
                           <option id="1" value="1">1</option>
                        </select>
                     </div>
                  </cfvl>
                  <cfact><button type="button" class="cbtn" id="LEDH" disabled>Update</button></cfact>
               </div>
            </div>
         </div>
         <hr class="confighr">
         <h2>Firmware Update</h2>
         <h3>Update Progress</h3>
         <p id="status" class="in30">No active update.</p>
         <p id="loaded_n_total" class="in30"><span id="filename"></span><span id="filesize"></span></p>
         <p id="otaerror" class="in30 errorText" display="hidden"></p>
         <h3>Web OTA Update</h3>
         <div id="fwUpdateAvailable" display="none" class="in30 dwn10">Release %FWUP% available. Your password is required.
           <!-- <input type="password" name="FWUP" class="cinp"  id="FWUPI" placeholder="Enter Password"/>
            <button type="button" class="cbtn" id="FWUP" disabled>Update</button> -->
            <input type="password" name="HTTPOTA" id="HTTPOTAPWD" placeholder="Enter Password"/>
            <input type="button" name="HTTPUPDATE" id="iupdate" value="Update" onclick="httpOTAUpload()" disabled />
         </div>
         <div id="fwUpdateNotAvailable" class="in30 dwn10" display="block">No update available. Currently at latest version.</div>
         <p class="in30" id="readfota">Please read the Web OTA Update&nbsp;<a href="https://hcomet.github.io/CheapoDC/CheapoDCWebUpdate.html" target="_blank">FAQ</a>.</p>
         <h3>Manual OTA Update</h3>
         <form id="uploadOTAFileForm" method="POST" action="/upload" class="in30 dwn10" enctype="multipart/form-data">
            <input type="file" name="file1" id="file1" value="Choose FW" /><input type="button" name="upload"
               id="iupload" value="Update" title="Upload File" onclick="fileOTAUpload()" disabled />
            </form>
         <hr class="confighr" >
         <h2>Reboot Device</h2>
         <p class="in30">Uptime: %UPT%  (HHH:MM:SS:MSec)</p>
         <button type="button" class="reboot" onclick="rebootDevice()">Reboot</button>
         
      </main>
      <footer>
         <hr class="footerThr">
         <button type="button" class="bfooter" onclick="document.location='../dashboard'">Dashboard</button>
         <button type="button" class="bfooter" onclick="document.location='../config'">Controller Configuration</button>
         <button type="button" class="bfooterDisabled" disabled>Device Management</button>
         <!-- onclick="document.location='../otaIndex'"-->
         <button type="button" class="bfooter" onclick="document.location='../listFiles'">File Management</button>
         <hr class="footerBhr">
         <div class="attribution">Cheapo Dew Controller - &copy; 2025 - Release: %FW% <br />(Heap: %HP%, File space:
            %LFS%)</div>
      </footer>
   </div>
   <script>
      // otaindex.html specific JS
      window.onload=function() {httpOTAAvailability("%FWUP%");loadWifi();};
      document.getElementById('file1').addEventListener('change', function () { document.getElementById('iupload').disabled = false; });
      document.getElementById('oldpassword').addEventListener('input', function () { checkPasswordUpdate() });
      document.getElementById('newpassword').addEventListener('input', function () { checkPasswordUpdate() });
      document.getElementById('confpassword').addEventListener('input', function () { checkPasswordUpdate() });
      document.getElementById('HTTPOTAPWD').addEventListener('input', function () { document.getElementById('iupdate').disabled = false; });
      document.getElementById("wifiName").addEventListener("change", function() { wifiSelectChange();});
      document.getElementById("wifiSSID").addEventListener("input", function() {document.getElementById("wifiButton").disabled = false;  });
      document.getElementById("wifiPassword").addEventListener("input", function() {document.getElementById("wifiButton").disabled = false;  });
      document.getElementById("hostname").addEventListener("input", function() {document.getElementById("hnButton").disabled = false;  });
   </script>
   <script src="CDCjs.js"></script>
</body>

</html>