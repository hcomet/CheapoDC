var MD5,modeCount=0,outstandingQueries=0,refreshCount=0;function onLoad(e){document.getElementById("loader").style.display="block",initButtons(),document.addEventListener("keydown",function(e){e.ctrlKey&&"z"===e.key&&initButtons()})}function convertHTML(e){let t={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&apos;":"'","&deg;":"\xb0","&percnt;":"%","&commat;":"@"},n=e,a=e;for(let d in t)a.indexOf(d)>=0&&(a=n=a.replaceAll(d,t[d]));return n}function encodeForHTTP(e){let t={"%":"%25","&":"%26","<":"%30",">":"%3E","?":"%3F","@":"%40",$:"%24","#":"%23"},n=e,a=e;for(let d in t)a.indexOf(d)>=0&&(a=n=a.replaceAll(d,t[d]));return n}function removeUnits(e){let t={0:"\xb0",1:"%",2:"min",3:"msec",4:"sec",5:"&"},n=e;for(j=0;j<=5;j++){var a=e.indexOf(t[j]);a>=0&&(n=e.substr(0,a),j=6)}return n}function setValue(e){var t=e.id,n=new XMLHttpRequest;n.open("POST","/getvalue",!0),n.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),n.responseType="json",n.onreadystatechange=()=>{if(n.readyState===XMLHttpRequest.DONE&&200===n.status){var e=n.response,t=Object.keys(e)[0],a=t+"I",d=t+"S",o=Object.values(e)[0];document.getElementById(a)?"number"==document.getElementById(a).type?document.getElementById(a).dataset.cdc=o:document.getElementById(a).dataset.cdc=convertHTML(o):document.getElementById(d)?document.getElementById(d).dataset.cdc=o:console.log("No Input or Select found for: "+t),(refreshCount-=1)<=0&&(refreshCount=0,initButtons())}},n.send("get="+t),refreshCount+=1}function refreshData(){(allcButtons=[...document.getElementsByClassName("cButton")]).forEach(function(e){setValue(e)})}function sendValue(e){var t,n=e+"I",a=e+"S";if(document.getElementById("loader").style.display="block",document.getElementById(n))t=document.getElementById(n).value;else if(document.getElementById(a))t=document.getElementById(a).value;else{console.log("No Input or Select found for: "+e);return}var d=new XMLHttpRequest;d.open("POST","/setvalue",!0),d.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),d.responseType="json",d.onreadystatechange=()=>{d.readyState===XMLHttpRequest.DONE&&200===d.status&&refreshData()},d.send(e+"="+encodeForHTTP(t)),document.getElementById(e).disabled=!0}function setChangeItem(e){var t=e.id,n=t+"I",a=t+"S";if(e.disabled=!0,document.getElementById(n)){var d=document.getElementById(n);switch(d.oninput=e=>{document.getElementById(t).disabled=!1,document.getElementById(t).onclick=function(){sendValue(t)}},d.type){case"number":d.value=removeUnits(d.dataset.cdc);break;case"text":case"url":d.value=d.dataset.cdc;break;default:console.log("Bad input type: "+d.type)}}else if(document.getElementById(a)){var d=document.getElementById(a);switch(d.onchange=e=>{document.getElementById(t).disabled=!1,document.getElementById(t).onclick=function(){sendValue(t)}},d.dataset.cdc){case"Automatic":case"Weather Query":case"Dew Point":case"Open-Meteo":case"Disabled":case"0":d.value=0;break;case"Manual":case"External Input":case"Temperature":case"OpenWeather":case"Controller":case"1":d.value=1;break;case"Off":case"Midpoint":case"External Source":case"PWM":d.value=2;break;case"Boolean":d.value=3;break;default:console.log("Bad Select value: "+d.dataset.cdc)}}else{console.log("No Input or Select found for: "+t);return}switch(t){case"DCM":1==document.getElementById("DCMS").value?(document.getElementById("DCO").className="cButton",document.getElementById("DCOI").disabled=!1):(document.getElementById("DCO").className="cButton hidden",document.getElementById("DCOI").disabled=!0);break;case"OMIN":var o=parseInt(document.getElementById("OMINI").value);document.getElementById("DCOI").setAttribute("min",o),document.getElementById("OMAXI").setAttribute("min",o+1);break;case"OMAX":var l=parseInt(document.getElementById("OMAXI").value);document.getElementById("DCOI").setAttribute("max",l),document.getElementById("OMINI").setAttribute("max",l-1);break;case"WS":2==document.getElementById("WSS").value?(document.getElementById("ATPQ").className="cButton",document.getElementById("ATPQI").disabled=!1,document.getElementById("HU").className="cButton",document.getElementById("HUI").disabled=!1):(document.getElementById("ATPQ").className="cButton hidden",document.getElementById("ATPQI").disabled=!0,document.getElementById("HU").className="cButton hidden",document.getElementById("HUI").disabled=!0);break;case"CPP0":case"CPP1":case"CPP2":case"CPP3":case"CPP4":case"CPP5":var r=t.substr(3,1);-1==document.getElementById(n).value?(document.getElementById("CPM"+r).className="cButton hidden",document.getElementById("CPM"+r+"S").disabled=!0):(document.getElementById("CPM"+r).className="cButton",document.getElementById("CPM"+r+"S").disabled=!1);break;case"CPM0":case"CPM1":case"CPM2":case"CPM3":case"CPM4":case"CPM5":var r=t.substr(3,1),s=document.getElementById(a).value;switch(s){case"0":case"1":document.getElementById("CPO"+r).className="cButton hidden",document.getElementById("CPO"+r+"I").disabled=!0;break;case"2":document.getElementById("CPO"+r).className="cButton",document.getElementById("CPO"+r+"I").disabled=!1,document.getElementById("CPO"+r+"I").setAttribute("step",1);break;case"3":document.getElementById("CPO"+r).className="cButton",document.getElementById("CPO"+r+"I").disabled=!1,document.getElementById("CPO"+r+"I").setAttribute("step",100)}}}function initButtons(){(allcButtons=[...document.getElementsByClassName("cButton")]).forEach(function(e){setChangeItem(e)}),document.getElementById("loader").style.display="none"}function logoutCDC(){var e=new XMLHttpRequest;e.open("GET","/logout",!0),e.send(),setTimeout(function(){window.open("/dashboard","_self")},1e3)}function httpOTAAvailability(e){"NOSUPPORT"==e?(document.getElementById("fwUpdateNotAvailable").style.display="block",document.getElementById("fwUpdateNotAvailable").innerHTML="Not supported.",document.getElementById("fwUpdateAvailable").style.display="none"):"NOFWUPDATE"!=e?(document.getElementById("fwUpdateAvailable").style.display="block",document.getElementById("fwUpdateNotAvailable").style.display="none"):(document.getElementById("fwUpdateNotAvailable").style.display="block",document.getElementById("fwUpdateNotAvailable").innerHTML="No update available. Currently at latest version.",document.getElementById("fwUpdateAvailable").style.display="none")}function updateOTAError(e){document.getElementById("otaerror"),console.log("OTA update error: "+e),""==e?document.getElementById("otaerror").style.display="hidden":document.getElementById("otaerror").style.display="block",document.getElementById("otaerror").innerHTML=e}function httpOTAUpload(){var e=MD5.generate("admin:CheapoDC:"+document.getElementById("HTTPOTAPWD").value),t=new XMLHttpRequest,n=new EventSource("/events");console.log("Set up HTTP OTA"),window.EventSource?(n.addEventListener("open",e=>{console.log("Events Connected"),document.getElementById("status").innerHTML="HTTP OTA Connected."}),n.addEventListener("status",e=>{console.log("status"+e.data),document.getElementById("filename").innerHTML=e.data}),n.addEventListener("error",e=>{e.target.readyState!=EventSource.OPEN?updateOTAError("Events Disconnected"):updateOTAError(e.data)}),n.addEventListener("message",e=>{console.log("message"+e.data),document.getElementById("status").innerHTML=e.data}),n.addEventListener("progress",e=>{httpOTAProgress(e.data)}),n.addEventListener("reboot",e=>{otaReboot(e.data)}),console.log("EventSource: "+n.url+" State: "+n.readyState)):console.log("something is broken"),t.open("POST","/updatehtml",!0),t.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),t.send("password="+encodeForHTTP(e)),console.log("Sent OTA request")}function httpOTAProgress(e){e>0?document.getElementById("filesize").innerHTML=" "+e+"&percnt; ":document.getElementById("filesize").innerHTML=" "}function otaReboot(e){"Refresh"==e&&setTimeout(function(){location.reload()},5e3)}function fileOTAUpload(){var e=document.getElementById("file1").files[0];document.getElementById("filename").innerHTML=document.getElementById("file1").value.replace(/.*[\/\\]/,"")+": ";var t=new FormData;t.append("method","file"),t.append("file1",e);var n=new XMLHttpRequest;n.upload.addEventListener("progress",progressHandler,!1),n.open("POST","/update"),n.send(t)}function progressHandler(e){document.getElementById("filesize").innerHTML=e.loaded+" bytes";var t=e.loaded/e.total*100;document.getElementById("status").innerHTML="Completed: "+Math.round(t)+"&percnt;",t>=100&&(document.getElementById("status").innerHTML="Completed: 100&percnt; Wait for Reload.",document.getElementById("iupload").disabled=!0,setTimeout(function(){location.reload()},5e3))}function rebootDevice(){confirm("Confirm Reboot")&&((xmlhttp=new XMLHttpRequest).open("GET","/reboot",!0),xmlhttp.send())}function logoutCDC(){var e=new XMLHttpRequest;e.open("GET","/logout",!0),e.send(),setTimeout(function(){window.open("/dashboard","_self")},1e3)}function checkPasswordUpdate(){console.log("Checking Passwords"),""!=document.getElementById("newpassword").value&&document.getElementById("newpassword").value==document.getElementById("confpassword").value&&""!=document.getElementById("oldpassword").value?document.getElementById("passwordButton").disabled=!1:document.getElementById("passwordButton").disabled=!0}function changePassword(){var e=MD5.generate("admin:CheapoDC:"+document.getElementById("newpassword").value),t=MD5.generate("admin:CheapoDC:"+document.getElementById("oldpassword").value);if(e!=MD5.generate("admin:CheapoDC:"+document.getElementById("confpassword").value)){alert("New Passwords do not match"),document.getElementById("passwordButton").disabled=!0;return}var n=new XMLHttpRequest;document.getElementById("loader").style.display="block",n.open("POST","/setpassword",!0),n.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),n.send("newpassword="+encodeForHTTP(e)+"&oldpassword="+encodeForHTTP(t)),setTimeout(function(){location.reload()},1e3)}(()=>{"use strict";var e={d(t,n){for(var a in n)e.o(n,a)&&!e.o(t,a)&&Object.defineProperty(t,a,{enumerable:!0,get:n[a]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}},t={};(()=>{e.r(t),e.d(t,{MD5:()=>u,generate:()=>a});var n=function(e){e=e.replace(/\r\n/g,"\n");for(var t="",n=0;n<e.length;n++){var a=e.charCodeAt(n);a<128?t+=String.fromCharCode(a):a>127&&a<2048?(t+=String.fromCharCode(a>>6|192),t+=String.fromCharCode(63&a|128)):(t+=String.fromCharCode(a>>12|224),t+=String.fromCharCode(a>>6&63|128),t+=String.fromCharCode(63&a|128))}return t};function a(e){var t,a,d,u,c,$,g,m,y,p;for(t=function(e){for(var t,n=e.length,a=n+8,d=16*((a-a%64)/64+1),o=Array(d-1),l=0,r=0;r<n;)l=r%4*8,o[t=(r-r%4)/4]=o[t]|e.charCodeAt(r)<<l,r++;return l=r%4*8,o[t=(r-r%4)/4]=o[t]|128<<l,o[d-2]=n<<3,o[d-1]=n>>>29,o}(n(e)),g=1732584193,m=4023233417,y=2562383102,p=271733878,a=0;a<t.length;a+=16)d=g,u=m,c=y,$=p,g=l(g,m,y,p,t[a+0],7,3614090360),p=l(p,g,m,y,t[a+1],12,3905402710),y=l(y,p,g,m,t[a+2],17,606105819),m=l(m,y,p,g,t[a+3],22,3250441966),g=l(g,m,y,p,t[a+4],7,4118548399),p=l(p,g,m,y,t[a+5],12,1200080426),y=l(y,p,g,m,t[a+6],17,2821735955),m=l(m,y,p,g,t[a+7],22,4249261313),g=l(g,m,y,p,t[a+8],7,1770035416),p=l(p,g,m,y,t[a+9],12,2336552879),y=l(y,p,g,m,t[a+10],17,4294925233),m=l(m,y,p,g,t[a+11],22,2304563134),g=l(g,m,y,p,t[a+12],7,1804603682),p=l(p,g,m,y,t[a+13],12,4254626195),y=l(y,p,g,m,t[a+14],17,2792965006),g=r(g,m=l(m,y,p,g,t[a+15],22,1236535329),y,p,t[a+1],5,4129170786),p=r(p,g,m,y,t[a+6],9,3225465664),y=r(y,p,g,m,t[a+11],14,643717713),m=r(m,y,p,g,t[a+0],20,3921069994),g=r(g,m,y,p,t[a+5],5,3593408605),p=r(p,g,m,y,t[a+10],9,38016083),y=r(y,p,g,m,t[a+15],14,3634488961),m=r(m,y,p,g,t[a+4],20,3889429448),g=r(g,m,y,p,t[a+9],5,568446438),p=r(p,g,m,y,t[a+14],9,3275163606),y=r(y,p,g,m,t[a+3],14,4107603335),m=r(m,y,p,g,t[a+8],20,1163531501),g=r(g,m,y,p,t[a+13],5,2850285829),p=r(p,g,m,y,t[a+2],9,4243563512),y=r(y,p,g,m,t[a+7],14,1735328473),g=s(g,m=r(m,y,p,g,t[a+12],20,2368359562),y,p,t[a+5],4,4294588738),p=s(p,g,m,y,t[a+8],11,2272392833),y=s(y,p,g,m,t[a+11],16,1839030562),m=s(m,y,p,g,t[a+14],23,4259657740),g=s(g,m,y,p,t[a+1],4,2763975236),p=s(p,g,m,y,t[a+4],11,1272893353),y=s(y,p,g,m,t[a+7],16,4139469664),m=s(m,y,p,g,t[a+10],23,3200236656),g=s(g,m,y,p,t[a+13],4,681279174),p=s(p,g,m,y,t[a+0],11,3936430074),y=s(y,p,g,m,t[a+3],16,3572445317),m=s(m,y,p,g,t[a+6],23,76029189),g=s(g,m,y,p,t[a+9],4,3654602809),p=s(p,g,m,y,t[a+12],11,3873151461),y=s(y,p,g,m,t[a+15],16,530742520),g=i(g,m=s(m,y,p,g,t[a+2],23,3299628645),y,p,t[a+0],6,4096336452),p=i(p,g,m,y,t[a+7],10,1126891415),y=i(y,p,g,m,t[a+14],15,2878612391),m=i(m,y,p,g,t[a+5],21,4237533241),g=i(g,m,y,p,t[a+12],6,1700485571),p=i(p,g,m,y,t[a+3],10,2399980690),y=i(y,p,g,m,t[a+10],15,4293915773),m=i(m,y,p,g,t[a+1],21,2240044497),g=i(g,m,y,p,t[a+8],6,1873313359),p=i(p,g,m,y,t[a+15],10,4264355552),y=i(y,p,g,m,t[a+6],15,2734768916),m=i(m,y,p,g,t[a+13],21,1309151649),g=i(g,m,y,p,t[a+4],6,4149444226),p=i(p,g,m,y,t[a+11],10,3174756917),y=i(y,p,g,m,t[a+2],15,718787259),m=i(m,y,p,g,t[a+9],21,3951481745),g=o(g,d),m=o(m,u),y=o(y,c),p=o(p,$);return _(g)+_(m)+_(y)+_(p)}function d(e,t){return e<<t|e>>>32-t}function o(e,t){var n,a,d,o,l;return d=2147483648&e,o=2147483648&t,l=(1073741823&e)+(1073741823&t),(n=1073741824&e)&(a=1073741824&t)?2147483648^l^d^o:n|a?1073741824&l?3221225472^l^d^o:1073741824^l^d^o:l^d^o}function l(e,t,n,a,l,r,s){var i,_,u;return e=o(e,o(o((i=t,_=n,i&_|~i&(u=a)),l),s)),o(d(e,r),t)}function r(e,t,n,a,l,r,s){var i,_,u;return e=o(e,o(o((i=t,_=n,i&(u=a)|_&~u),l),s)),o(d(e,r),t)}function s(e,t,n,a,l,r,s){var i,_,u;return e=o(e,o(o((i=t,_=n,i^_^(u=a)),l),s)),o(d(e,r),t)}function i(e,t,n,a,l,r,s){var i,_,u;return e=o(e,o(o((i=t,_=n,_^(i|~(u=a))),l),s)),o(d(e,r),t)}function _(e){var t,n="",a="";for(t=0;t<=3;t++)n+=(a="0"+(e>>>8*t&255).toString(16)).substr(a.length-2,2);return n}var u={generate:a}})(),MD5=t})(),window.addEventListener("load",onLoad);