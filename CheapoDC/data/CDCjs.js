var MD5,modeCount=0,outstandingQueries=0,refreshCount=0;function onLoad(e){document.getElementById("loader").style.display="block",initButtons(),document.addEventListener("keydown",function(e){e.ctrlKey&&"z"===e.key&&initButtons()})}function convertHTML(e){let t={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&apos;":"'","&deg;":"\xb0","&percnt;":"%","&commat;":"@"},n=e,a=e;for(let d in t)a.indexOf(d)>=0&&(a=n=a.replaceAll(d,t[d]));return n}function encodeForHTTP(e){let t={"%":"%25","&":"%26","<":"%30",">":"%3E","?":"%3F","@":"%40",$:"%24","#":"%23"},n=e,a=e;for(let d in t)a.indexOf(d)>=0&&(a=n=a.replaceAll(d,t[d]));return n}function removeUnits(e){let t={0:"\xb0",1:"%",2:"min",3:"msec",4:"sec",5:"&"},n=e;for(j=0;j<=5;j++){var a=e.indexOf(t[j]);a>=0&&(n=e.substr(0,a),j=6)}return n}function setValue(e){var t=e.id,n=new XMLHttpRequest;n.open("POST","/getvalue",!0),n.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),n.responseType="json",n.onreadystatechange=()=>{if(n.readyState===XMLHttpRequest.DONE&&200===n.status){var e=n.response,t=Object.keys(e)[0],a=t+"I",d=t+"S",l=Object.values(e)[0];document.getElementById(a)?"number"==document.getElementById(a).type?document.getElementById(a).dataset.cdc=l:document.getElementById(a).dataset.cdc=convertHTML(l):document.getElementById(d)?document.getElementById(d).dataset.cdc=l:console.log("No Input or Select found for: "+t),(refreshCount-=1)<=0&&(refreshCount=0,initButtons())}},n.send("get="+t),refreshCount+=1}function refreshData(){(allcButtons=[...document.getElementsByClassName("cButton")]).forEach(function(e){setValue(e)})}function sendValue(e){var t,n=e+"I",a=e+"S";if(document.getElementById("loader").style.display="block",document.getElementById(n))t=document.getElementById(n).value;else if(document.getElementById(a))t=document.getElementById(a).value;else{console.log("No Input or Select found for: "+e);return}var d=new XMLHttpRequest;d.open("POST","/setvalue",!0),d.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),d.responseType="json",d.onreadystatechange=()=>{d.readyState===XMLHttpRequest.DONE&&200===d.status&&refreshData()},d.send(e+"="+encodeForHTTP(t)),document.getElementById(e).disabled=!0}function setChangeItem(e){var t=e.id,n=t+"I",a=t+"S";if(e.disabled=!0,document.getElementById(n)){var d=document.getElementById(n);switch(d.oninput=e=>{document.getElementById(t).disabled=!1,document.getElementById(t).onclick=function(){sendValue(t)}},d.type){case"number":d.value=removeUnits(d.dataset.cdc);break;case"text":case"url":d.value=d.dataset.cdc;break;default:console.log("Bad input type: "+d.type)}}else if(document.getElementById(a)){var d=document.getElementById(a);switch(d.onchange=e=>{document.getElementById(t).disabled=!1,document.getElementById(t).onclick=function(){sendValue(t)}},d.dataset.cdc){case"Automatic":case"Weather Query":case"Dew Point":case"Open-Meteo":case"Disabled":case"0":d.value=0;break;case"Manual":case"External Input":case"Temperature":case"OpenWeather":case"Controller":case"1":d.value=1;break;case"Off":case"Midpoint":case"External Source":case"PWM":d.value=2;break;case"Boolean":d.value=3;break;default:console.log("Bad Select value: "+d.dataset.cdc)}}else{console.log("No Input or Select found for: "+t);return}switch(t){case"DCM":1==document.getElementById("DCMS").value?(document.getElementById("DCO").className="cButton",document.getElementById("DCOI").disabled=!1):(document.getElementById("DCO").className="cButton hidden",document.getElementById("DCOI").disabled=!0);break;case"OMIN":var l=parseInt(document.getElementById("OMINI").value);document.getElementById("DCOI").setAttribute("min",l),document.getElementById("OMAXI").setAttribute("min",l+1);break;case"OMAX":var o=parseInt(document.getElementById("OMAXI").value);document.getElementById("DCOI").setAttribute("max",o),document.getElementById("OMINI").setAttribute("max",o-1);break;case"WS":2==document.getElementById("WSS").value?(document.getElementById("ATPQ").className="cButton",document.getElementById("ATPQI").disabled=!1,document.getElementById("HU").className="cButton",document.getElementById("HUI").disabled=!1):(document.getElementById("ATPQ").className="cButton hidden",document.getElementById("ATPQI").disabled=!0,document.getElementById("HU").className="cButton hidden",document.getElementById("HUI").disabled=!0);break;case"CPP0":case"CPP1":case"CPP2":case"CPP3":case"CPP4":case"CPP5":var s=t.substr(3,1);-1==document.getElementById(n).value?(document.getElementById("CPM"+s).className="cButton hidden",document.getElementById("CPM"+s+"S").disabled=!0):(document.getElementById("CPM"+s).className="cButton",document.getElementById("CPM"+s+"S").disabled=!1);break;case"CPM0":case"CPM1":case"CPM2":case"CPM3":case"CPM4":case"CPM5":var s=t.substr(3,1),r=document.getElementById(a).value;switch(r){case"0":case"1":document.getElementById("CPO"+s).className="cButton hidden",document.getElementById("CPO"+s+"I").disabled=!0;break;case"2":document.getElementById("CPO"+s).className="cButton",document.getElementById("CPO"+s+"I").disabled=!1,document.getElementById("CPO"+s+"I").setAttribute("step",1);break;case"3":document.getElementById("CPO"+s).className="cButton",document.getElementById("CPO"+s+"I").disabled=!1,document.getElementById("CPO"+s+"I").setAttribute("step",100)}}}function initButtons(){(allcButtons=[...document.getElementsByClassName("cButton")]).forEach(function(e){setChangeItem(e)}),document.getElementById("loader").style.display="none"}function logoutCDC(){var e=new XMLHttpRequest;e.open("GET","/logout",!0),e.send(),setTimeout(function(){window.open("/dashboard","_self")},1e3)}function httpOTAAvailability(e){"NOSUPPORT"==e?(document.getElementById("fwUpdateNotAvailable").style.display="block",document.getElementById("fwUpdateNotAvailable").innerHTML="Not supported.",document.getElementById("fwUpdateAvailable").style.display="none"):"NOFWUPDATE"!=e?(document.getElementById("fwUpdateAvailable").style.display="block",document.getElementById("fwUpdateNotAvailable").style.display="none"):(document.getElementById("fwUpdateNotAvailable").style.display="block",document.getElementById("fwUpdateNotAvailable").innerHTML="No update available. Currently at latest version.",document.getElementById("fwUpdateAvailable").style.display="none")}function updateOTAError(e){document.getElementById("otaerror"),console.log("OTA update error: "+e),""==e?document.getElementById("otaerror").style.display="hidden":document.getElementById("otaerror").style.display="block",document.getElementById("otaerror").innerHTML=e}function httpOTAUpload(){var e=MD5.generate("admin:CheapoDC:"+document.getElementById("HTTPOTAPWD").value),t=new XMLHttpRequest,n=new EventSource("/events");window.EventSource?(n.addEventListener("open",e=>{document.getElementById("status").innerHTML="HTTP OTA Connected."}),n.addEventListener("status",e=>{document.getElementById("filename").innerHTML=e.data}),n.addEventListener("error",e=>{e.target.readyState!=EventSource.OPEN?updateOTAError("Events Disconnected"):updateOTAError(e.data)}),n.addEventListener("message",e=>{document.getElementById("status").innerHTML=e.data}),n.addEventListener("progress",e=>{httpOTAProgress(e.data)}),n.addEventListener("reboot",e=>{otaReboot(e.data)})):console.log("something is broken"),t.open("POST","/updatehtml",!0),t.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),t.send("password="+encodeForHTTP(e))}function httpOTAProgress(e){e>0?document.getElementById("filesize").innerHTML=" "+e+"&percnt; ":document.getElementById("filesize").innerHTML=" "}function otaReboot(e){"Refresh"==e&&setTimeout(function(){location.reload()},5e3)}function fileOTAUpload(){var e=document.getElementById("file1").files[0];document.getElementById("filename").innerHTML=document.getElementById("file1").value.replace(/.*[\/\\]/,"")+": ";var t=new FormData;t.append("method","file"),t.append("file1",e);var n=new XMLHttpRequest;n.upload.addEventListener("progress",progressHandler,!1),n.open("POST","/update"),n.send(t)}function progressHandler(e){document.getElementById("filesize").innerHTML=e.loaded+" bytes";var t=e.loaded/e.total*100;document.getElementById("status").innerHTML="Completed: "+Math.round(t)+"&percnt;",t>=100&&(document.getElementById("status").innerHTML="Completed: 100&percnt; Wait for Reload.",document.getElementById("iupload").disabled=!0,setTimeout(function(){location.reload()},5e3))}function rebootDevice(){confirm("Confirm Reboot")&&((xmlhttp=new XMLHttpRequest).open("GET","/reboot",!0),xmlhttp.send())}function logoutCDC(){var e=new XMLHttpRequest;e.open("GET","/logout",!0),e.send(),setTimeout(function(){window.open("/dashboard","_self")},1e3)}function checkPasswordUpdate(){""!=document.getElementById("newpassword").value&&document.getElementById("newpassword").value==document.getElementById("confpassword").value&&""!=document.getElementById("oldpassword").value?document.getElementById("passwordButton").disabled=!1:document.getElementById("passwordButton").disabled=!0}function changePassword(){var e=MD5.generate("admin:CheapoDC:"+document.getElementById("newpassword").value),t=MD5.generate("admin:CheapoDC:"+document.getElementById("oldpassword").value);if(e!=MD5.generate("admin:CheapoDC:"+document.getElementById("confpassword").value)){alert("New Passwords do not match"),document.getElementById("passwordButton").disabled=!0;return}var n=new XMLHttpRequest;document.getElementById("loader").style.display="block",n.open("POST","/setpassword",!0),n.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),n.send("newpassword="+encodeForHTTP(e)+"&oldpassword="+encodeForHTTP(t)),setTimeout(function(){location.reload()},1e3)}async function loadWifi(){var e,t,n={},a=[],d=document.getElementById("wifiName"),l=document.getElementById("wifiSSID"),o=document.getElementById("wifiPassword");document.getElementById("wifiButton").disabled=!0,document.getElementById("wifiPwdCheck").checked=!1,document.getElementById("wifiPassword").type="password",document.getElementById("loader").style.display="block";try{if((e=await fetch("CDCWiFi.json")).ok)a=(n=await e.json()).wifi;else throw Error(`Response status: ${e.status}`)}catch(s){console.error(s.message)}for(var r=d.options.length-1;r>=0;r--)d.remove(r);for(var r=0;r<a.length;r++)(t=document.createElement("option")).text=a[r].ssid,t.value=r,d.add(t,d[r]);(t=document.createElement("option")).text="Add Wifi",t.value=a.length,d.add(t,d[a.length]),0==a.length?(l.value="",l.placeholder="Enter SSID",o.value="",o.placeholder="Enter Password"):(l.value=a[0].ssid,o.value=a[0].password),document.getElementById("loader").style.display="none",d.addEventListener("change",function(){var e=d.value;if(document.getElementById("wifiPassword").type="password",document.getElementById("wifiPwdCheck").checked=!1,e==a.length){l.value="",l.placeholder="Enter SSID",o.value="",o.placeholder="Enter Password";return}l.value=a[e].ssid,o.value=a[e].password}),l.addEventListener("input",function(){document.getElementById("wifiButton").disabled=!1}),o.addEventListener("input",function(){document.getElementById("wifiButton").disabled=!1}),document.getElementById("wifiButton").addEventListener("click",function(){updateWifi(d,l,o,a,n)})}function updateWifi(e,t,n,a,d){var l=e.value;let o={...d};if(document.getElementById("loader").style.display="block",l==a.length){var s={};s.ssid=t.value,s.password=n.value,a.push(s)}else a[l].ssid=t.value,a[l].password=n.value;for(var r=[],i=0;i<a.length;i++)""!=a[i].ssid&&r.push(a[i]);o.wifi=r;var u=new XMLHttpRequest;document.getElementById("loader").style.display="block",u.open("POST","/setwifi",!0),u.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),u.onreadystatechange=function(){4==u.readyState&&200==u.status&&loadWifi()},u.send("wifi="+encodeForHTTP(JSON.stringify(o)))}function showWifiPassword(){var e=document.getElementById("wifiPassword"),t=document.getElementById("wifiName");t.value==t.options.length-1?"password"===e.type?e.type="text":e.type="password":document.getElementById("wifiPwdCheck").checked=!1}(()=>{"use strict";var e={d(t,n){for(var a in n)e.o(n,a)&&!e.o(t,a)&&Object.defineProperty(t,a,{enumerable:!0,get:n[a]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}},t={};(()=>{e.r(t),e.d(t,{MD5:()=>c,generate:()=>a});var n=function(e){e=e.replace(/\r\n/g,"\n");for(var t="",n=0;n<e.length;n++){var a=e.charCodeAt(n);a<128?t+=String.fromCharCode(a):a>127&&a<2048?(t+=String.fromCharCode(a>>6|192),t+=String.fromCharCode(63&a|128)):(t+=String.fromCharCode(a>>12|224),t+=String.fromCharCode(a>>6&63|128),t+=String.fromCharCode(63&a|128))}return t};function a(e){var t,a,d,c,_,y,m,g,$,p;for(t=function(e){for(var t,n=e.length,a=n+8,d=16*((a-a%64)/64+1),l=Array(d-1),o=0,s=0;s<n;)o=s%4*8,l[t=(s-s%4)/4]=l[t]|e.charCodeAt(s)<<o,s++;return o=s%4*8,l[t=(s-s%4)/4]=l[t]|128<<o,l[d-2]=n<<3,l[d-1]=n>>>29,l}(n(e)),m=1732584193,g=4023233417,$=2562383102,p=271733878,a=0;a<t.length;a+=16)d=m,c=g,_=$,y=p,m=o(m,g,$,p,t[a+0],7,3614090360),p=o(p,m,g,$,t[a+1],12,3905402710),$=o($,p,m,g,t[a+2],17,606105819),g=o(g,$,p,m,t[a+3],22,3250441966),m=o(m,g,$,p,t[a+4],7,4118548399),p=o(p,m,g,$,t[a+5],12,1200080426),$=o($,p,m,g,t[a+6],17,2821735955),g=o(g,$,p,m,t[a+7],22,4249261313),m=o(m,g,$,p,t[a+8],7,1770035416),p=o(p,m,g,$,t[a+9],12,2336552879),$=o($,p,m,g,t[a+10],17,4294925233),g=o(g,$,p,m,t[a+11],22,2304563134),m=o(m,g,$,p,t[a+12],7,1804603682),p=o(p,m,g,$,t[a+13],12,4254626195),$=o($,p,m,g,t[a+14],17,2792965006),m=s(m,g=o(g,$,p,m,t[a+15],22,1236535329),$,p,t[a+1],5,4129170786),p=s(p,m,g,$,t[a+6],9,3225465664),$=s($,p,m,g,t[a+11],14,643717713),g=s(g,$,p,m,t[a+0],20,3921069994),m=s(m,g,$,p,t[a+5],5,3593408605),p=s(p,m,g,$,t[a+10],9,38016083),$=s($,p,m,g,t[a+15],14,3634488961),g=s(g,$,p,m,t[a+4],20,3889429448),m=s(m,g,$,p,t[a+9],5,568446438),p=s(p,m,g,$,t[a+14],9,3275163606),$=s($,p,m,g,t[a+3],14,4107603335),g=s(g,$,p,m,t[a+8],20,1163531501),m=s(m,g,$,p,t[a+13],5,2850285829),p=s(p,m,g,$,t[a+2],9,4243563512),$=s($,p,m,g,t[a+7],14,1735328473),m=r(m,g=s(g,$,p,m,t[a+12],20,2368359562),$,p,t[a+5],4,4294588738),p=r(p,m,g,$,t[a+8],11,2272392833),$=r($,p,m,g,t[a+11],16,1839030562),g=r(g,$,p,m,t[a+14],23,4259657740),m=r(m,g,$,p,t[a+1],4,2763975236),p=r(p,m,g,$,t[a+4],11,1272893353),$=r($,p,m,g,t[a+7],16,4139469664),g=r(g,$,p,m,t[a+10],23,3200236656),m=r(m,g,$,p,t[a+13],4,681279174),p=r(p,m,g,$,t[a+0],11,3936430074),$=r($,p,m,g,t[a+3],16,3572445317),g=r(g,$,p,m,t[a+6],23,76029189),m=r(m,g,$,p,t[a+9],4,3654602809),p=r(p,m,g,$,t[a+12],11,3873151461),$=r($,p,m,g,t[a+15],16,530742520),m=i(m,g=r(g,$,p,m,t[a+2],23,3299628645),$,p,t[a+0],6,4096336452),p=i(p,m,g,$,t[a+7],10,1126891415),$=i($,p,m,g,t[a+14],15,2878612391),g=i(g,$,p,m,t[a+5],21,4237533241),m=i(m,g,$,p,t[a+12],6,1700485571),p=i(p,m,g,$,t[a+3],10,2399980690),$=i($,p,m,g,t[a+10],15,4293915773),g=i(g,$,p,m,t[a+1],21,2240044497),m=i(m,g,$,p,t[a+8],6,1873313359),p=i(p,m,g,$,t[a+15],10,4264355552),$=i($,p,m,g,t[a+6],15,2734768916),g=i(g,$,p,m,t[a+13],21,1309151649),m=i(m,g,$,p,t[a+4],6,4149444226),p=i(p,m,g,$,t[a+11],10,3174756917),$=i($,p,m,g,t[a+2],15,718787259),g=i(g,$,p,m,t[a+9],21,3951481745),m=l(m,d),g=l(g,c),$=l($,_),p=l(p,y);return u(m)+u(g)+u($)+u(p)}function d(e,t){return e<<t|e>>>32-t}function l(e,t){var n,a,d,l,o;return d=2147483648&e,l=2147483648&t,o=(1073741823&e)+(1073741823&t),(n=1073741824&e)&(a=1073741824&t)?2147483648^o^d^l:n|a?1073741824&o?3221225472^o^d^l:1073741824^o^d^l:o^d^l}function o(e,t,n,a,o,s,r){var i,u,c;return e=l(e,l(l((i=t,u=n,i&u|~i&(c=a)),o),r)),l(d(e,s),t)}function s(e,t,n,a,o,s,r){var i,u,c;return e=l(e,l(l((i=t,u=n,i&(c=a)|u&~c),o),r)),l(d(e,s),t)}function r(e,t,n,a,o,s,r){var i,u,c;return e=l(e,l(l((i=t,u=n,i^u^(c=a)),o),r)),l(d(e,s),t)}function i(e,t,n,a,o,s,r){var i,u,c;return e=l(e,l(l((i=t,u=n,u^(i|~(c=a))),o),r)),l(d(e,s),t)}function u(e){var t,n="",a="";for(t=0;t<=3;t++)n+=(a="0"+(e>>>8*t&255).toString(16)).substr(a.length-2,2);return n}var c={generate:a}})(),MD5=t})(),window.addEventListener("load",onLoad);